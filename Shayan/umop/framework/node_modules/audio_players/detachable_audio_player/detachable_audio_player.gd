extends Node

@export var RandomAudioPlayer: PackedScene = null
@export var SelfDestroy: PackedScene = null

@onready var random_audio_player: = $RandomAudioPlayer



func play(pitch = - 1.0) -> void :
	random_audio_player.play(pitch)


func play_detached(pitch = - 1.0) -> void :
	var new_player = RandomAudioPlayer.instantiate()
	for s in random_audio_player.get_children():
		var new_stream: = AudioStreamPlayer.new()
		new_stream.stream = s.stream
		new_stream.volume_db = s.volume_db
		new_stream.bus = s.bus
		new_stream.stop()

		new_player.add_child(new_stream)

	new_player.add_child(SelfDestroy.instantiate())

	Game.add_child(new_player)
	new_player.sounds_to_play = random_audio_player.sounds_to_play
	new_player.min_pitch = random_audio_player.min_pitch
	new_player.max_pitch = random_audio_player.max_pitch
	new_player.volume_db = random_audio_player.volume_db
	new_player.play(pitch)
