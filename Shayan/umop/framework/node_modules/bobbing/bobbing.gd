extends Node2D

@export (NodePath)onready var target = (get_node(target) as Node2D) if target else get_parent()
@export var top := Vector2.UP
@export var bottom := Vector2.DOWN
@export var duration := 1.0

var _bobbing_positions: = []
var _initial_position: = Vector2.ZERO

@onready var tween: = $Tween



func _ready() -> void :
	tween.connect("tween_all_completed", Callable(self, "_on_tween_tween_all_completed"))

	_bobbing_positions.resize(2)
	_bobbing_positions[0] = top
	_bobbing_positions[1] = bottom
	_initial_position = target.position

	bob()


func bob() -> void :
	tween.interpolate_property(target, "position", _initial_position + _bobbing_positions[0], _initial_position + _bobbing_positions[1], duration, Tween.TRANS_QUAD, Tween.EASE_IN_OUT)
	tween.start()
	_bobbing_positions.invert()



func _on_tween_tween_all_completed() -> void :
	bob()
